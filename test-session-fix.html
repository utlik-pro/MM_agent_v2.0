<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Å—Å–∏–π</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }
        .widget-info {
            background: #f3e5f5;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #9c27b0;
        }
        .success {
            background: #e8f5e8;
            border-color: #4caf50;
        }
        .error {
            background: #ffebee;
            border-color: #f44336;
        }
        .log {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –¢–µ—Å—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Å—Å–∏–π</h1>
        
        <div class="test-info">
            <h3>–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º:</h3>
            <ul>
                <li>–í–∏–¥–∂–µ—Ç –ù–ï –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ "test-room"</li>
                <li>–ö–∞–∂–¥–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å–µ—Å—Å–∏—é</li>
                <li>–§–æ—Ä–º–∞—Ç –∫–æ–º–Ω–∞—Ç—ã: session-{timestamp}-{random}</li>
            </ul>
        </div>

        <div id="widget-status" class="widget-info">
            üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∏–¥–∂–µ—Ç...
        </div>

        <div id="session-log" class="log"></div>

        <button onclick="location.reload()" style="padding: 10px 20px; font-size: 16px; margin: 10px 0;">
            üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é
        </button>
    </div>

    <!-- –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–∏–¥–∂–µ—Ç -->
    <iframe 
        id="voice-widget"
        src="https://mm-agent-v2-0.vercel.app/"
        style="
            border: 0;
            width: 200px;
            height: 120px;
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background: transparent;
        "
        allow="microphone"
        title="–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫"
    ></iframe>

    <script>
        const widgetStatus = document.getElementById('widget-status');
        const sessionLog = document.getElementById('session-log');
        
        function addLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            sessionLog.innerHTML += `[${timestamp}] ${message}\n`;
            sessionLog.scrollTop = sessionLog.scrollHeight;
        }

        // –°–ª—É—à–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –≤–∏–¥–∂–µ—Ç–∞
        window.addEventListener('message', (event) => {
            console.log('Message from widget:', event.data);
            
            if (event.data.type === 'widget-ready') {
                const sessionId = event.data.sessionId;
                const roomName = event.data.roomName;
                
                addLog(`‚úÖ –í–∏–¥–∂–µ—Ç –≥–æ—Ç–æ–≤!`);
                addLog(`üÜî Session ID: ${sessionId}`);
                addLog(`üè† Room Name: ${roomName}`);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç
                if (sessionId && sessionId.startsWith('session-')) {
                    widgetStatus.innerHTML = `‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞: ${sessionId}`;
                    widgetStatus.className = 'widget-info success';
                    addLog(`‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù: –°–µ—Å—Å–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è!`);
                } else if (roomName === 'test-room') {
                    widgetStatus.innerHTML = `‚ùå –û–®–ò–ë–ö–ê: –í–∏–¥–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ test-room!`;
                    widgetStatus.className = 'widget-info error';
                    addLog(`‚ùå –¢–ï–°–¢ –ù–ï –ü–†–û–ô–î–ï–ù: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è test-room!`);
                } else {
                    widgetStatus.innerHTML = `‚ö†Ô∏è –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–º–Ω–∞—Ç—ã: ${roomName}`;
                    widgetStatus.className = 'widget-info';
                    addLog(`‚ö†Ô∏è –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: ${roomName}`);
                }
            }
        });

        // –¢–∞–π–º–∞—É—Ç
        setTimeout(() => {
            if (widgetStatus.innerHTML.includes('–ó–∞–≥—Ä—É–∂–∞–µ–º')) {
                widgetStatus.innerHTML = '‚ùå –í–∏–¥–∂–µ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç (—Ç–∞–π–º–∞—É—Ç)';
                widgetStatus.className = 'widget-info error';
                addLog('‚ùå –¢–∞–π–º–∞—É—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–∂–µ—Ç–∞');
            }
        }, 10000);

        addLog('üöÄ –¢–µ—Å—Ç –∑–∞–ø—É—â–µ–Ω');
        addLog('‚è≥ –û–∂–∏–¥–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤–∏–¥–∂–µ—Ç–∞...');
    </script>
</body>
</html> 